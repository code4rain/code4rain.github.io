<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Python | Code4Rain`s Blog]]></title>
  <link href="http://code4rain.github.com/blog/categories/python/atom.xml" rel="self"/>
  <link href="http://code4rain.github.com/"/>
  <updated>2014-03-21T11:46:10+09:00</updated>
  <id>http://code4rain.github.com/</id>
  <author>
    <name><![CDATA[Alex Kyoungdon Jang]]></name>
    <email><![CDATA[code4rain@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Change Outlook Subject with Python]]></title>
    <link href="http://code4rain.github.com/blog/2014/03/21/change-outlook-subject-with-python/"/>
    <updated>2014-03-21T10:42:00+09:00</updated>
    <id>http://code4rain.github.com/blog/2014/03/21/change-outlook-subject-with-python</id>
    <content type="html"><![CDATA[<h3>동기</h3>

<p>회사 메일의 prefix들 - <code>Re:</code>, <code>RE:</code>, <code>Fwd:</code>, <code>FWD:</code>로 인해서 아웃룩 대화보기가 되지 않았습니다. (대화보기를 사용하면 같은 주제별로 메일을 묶어주니 확인해야할 양이 많이 줄어들죠.)</p>

<h3>Reference</h3>

<p>Stack Overflow:
<em><a href="http://stackoverflow.com/questions/1440233/possible-to-intercept-and-rewrite-email-on-outlook-client-side-using-ironpython">http://stackoverflow.com/questions/1440233/possible-to-intercept-and-rewrite-email-on-outlook-client-side-using-ironpython</a></em></p>

<h3>적용 방법</h3>

<ol>
<li>Download Python
Test version 2.7.5 <a href="http://www.python.org/ftp/python/2.7.5/python-2.7.5.msi">python</a></li>
<li>Download pywin
Test version pywin32-218-win32-py2.7 <a href="http://sourceforge.net/projects/pywin32/files/pywin32/Build">pywin32</a></li>
<li>Download Redemption DLL
Test version <a href="http://www.dimastr.com/redemption/Redemption.zip">Redemption</a>
-- IF you use OUTLOOK 64bit, download python, pywin 64bit(x64) instead of 32bit(x86).</li>
<li>Make script - convert.py
``` python
import os, sys, re
import win32com.client</li>
</ol>


<p>from win32com.client import Dispatch, constants</p>

<p>def parse_folder(folder):</p>

<pre><code>print "Processing ## %s "%folder.Name.encode('euc-kr')
items = folder.Items
while True:
    item = items.GetNext()
    if item == None:
        print "Done"
        break
    #print '\n'.join(dir(item))

    objrdoitem = session.GetMessageFromID(item.EntryID, item.Parent.StoreID)

    sys.stdout.write('.')

    if objrdoitem.ConversationIndex == '' :
        continue

    if objrdoitem.ConversationIndex != '' :
        objrdoitem.ConversationIndex = ''
        objrdoitem.Save()

    if re.compile(r'(Re|RE|Fwd|FW|Rq)+:*\s*:*(\d+|\[\d+\]|\(x*\d+\)|:|\*\d+|\(\d+\))+\s*:*\s*').search(item.ConversationTopic):
        NewTopic = re.sub(r'(Re|RE|Fwd|FW)+:*\s*:*(\d+|\[\d+\]|\(x*\d+\)|:|\*\d+|\(\d+\))+\s*:*\s*','', item.ConversationTopic)
        objrdoitem.ConversationTopic = NewTopic
        objrdoitem.Save()

    if re.compile(r'(Re|RE|Fwd|FW|Rq)+:*\s*:*(\d+|\[\d+\]|\(x*\d+\)|:|\*\d+|\(\d+\))+\s*:*\s*').search(item.Subject):
        NewTopic = re.sub(r'(Re|RE|Fwd|FW)+:*\s*:*(\d+|\[\d+\]|\(x*\d+\)|:|\*\d+|\(\d+\))+\s*:*\s*','', item.Subject)
        objrdoitem.ConversationTopic = NewTopic
        objrdoitem.Save()
        #break

for i in range(1, folder.Folders.Count + 1):
    parse_folder(folder.Folders[i])
</code></pre>

<p>win32com.client.gencache.EnsureDispatch("Outlook.Application")
outlook = win32com.client.Dispatch("Outlook.Application")
mapi = outlook.GetNamespace('MAPI')
mapi.Logon()
session = win32com.client.Dispatch("Redemption.RDOSession")
session.Logon()</p>

<h1>top = mapi.Folders.Item("Archives")</h1>

<p>for i in range(1, mapi.Folders.Count + 1):</p>

<pre><code>    parse_folder(mapi.Folders[i])
</code></pre>

<p>```</p>

<ol>
<li>Run script
 <code>&lt;python path&gt;\python convert.py</code></li>
</ol>

]]></content>
  </entry>
  
</feed>
